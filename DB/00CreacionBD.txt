CREATE TABLE COMPANIAS(
    IDCOMPANIA 	SERIAL		PRIMARY KEY	,
    NOMBRE		VARCHAR(50)	NOT NULL	UNIQUE,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL
);

CREATE TABLE SUCURSALESXCOMPANIAS(
    IDCOMPANIA		INT,
    IDSUCURSAL		INT,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
    PRIMARY KEY (IDCOMPANIA,IDSUCURSAL)
);

CREATE TABLE SUCURSALES(
    IDSUCURSAL 	SERIAL		PRIMARY KEY	,
    NOMBRE			VARCHAR(50)	NOT NULL UNIQUE,
    IDDIRECCION	INT	NOT NULL,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL
);

CREATE TABLE FACTURASXSUCURSALES(
    IDSUCURSAL 	INT	NOT NULL,
    IDFACTURA		INT NOT NULL,
    NUMEROCONSECUTIVO	INT	NOT NULL,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
    PRIMARY KEY (IDSUCURSAL,IDFACTURA)
);

CREATE TABLE PERSONASXSUCURSALES(
    IDCEDULA			INT,
    IDSUCURSAL		INT,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
    PRIMARY KEY (IDCEDULA,IDSUCURSAL)
);

CREATE TABLE PERSONAS(
    IDCEDULA 	INT		PRIMARY KEY	,
    CONTRASENA		VARCHAR(50)	NOT NULL,
    NOMBRE		VARCHAR(50)	NOT NULL,
    APELLIDO1	VARCHAR(50)	NOT NULL,
    APELLIDO2	VARCHAR(50)	NOT NULL,
    TELEFONO	INT			NOT NULL,
    IDDIRECCION	INT			NOT NULL,
    FECHANACIMIENTO	DATE		NOT NULL,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL
);

CREATE TABLE ROLESXPERSONAS(
    IDCEDULA		INT,
    IDROL			INT,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
    PRIMARY KEY (IDCEDULA,IDROL)
);

CREATE TABLE ROLES(
    IDROL		SERIAL	PRIMARY KEY,
    NOMBRE		VARCHAR(50) UNIQUE,
    DESCRIPCION	VARCHAR(50),
    LOGICDELETE		BIT		DEFAULT 0::BIT		NOT NULL
);

CREATE TABLE PROVEEDORES(
	IDPROVEEDOR SERIAL PRIMARY KEY,
  	NOMBRE VARCHAR(50) NOT NULL UNIQUE,
  	DESCRIPCION VARCHAR(50),
  	LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL
);

CREATE TABLE PRODUCTOSXPROVEEDORES(
    IDPRODUCTO INT NOT NULL,
    IDPROVEEDOR INT NOT NULL,
    PRECIO INT NOT NULL,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
    PRIMARY KEY (IDPRODUCTO,IDPROVEEDOR)
);

CREATE TABLE PRODUCTOS(
	IDPRODUCTO SERIAL PRIMARY KEY,
  	NOMBRE VARCHAR(50) NOT NULL UNIQUE,
  	DESCRIPCION VARCHAR(50),
  	LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL

);

CREATE TABLE PRODUCTOSXFACTURAS(
	IDFACTURA INT NOT NULL,
  	IDPRODUCTO INT NOT NULL,
  	CANTIDAD INT,
  	LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
	PRIMARY KEY (IDFACTURA,IDPRODUCTO)
);

CREATE TABLE FACTURAS(
	IDFACTURA SERIAL PRIMARY KEY,
  	FECHA DATE NOT NULL,
  	LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL
		
);

CREATE TABLE FORMAPAGOSXFACTURAS(
	IDFACTURA INT NOT NULL,
  	IDFORMAPAGO INT NOT NULL,
  	LOGICDELETE	BIT	DEFAULT 0::BIT		NOT NULL,
	PRIMARY KEY (IDFACTURA,IDFORMAPAGO)
);

CREATE TABLE FORMAPAGOS(
	IDFORMAPAGO SERIAL PRIMARY KEY,
  	NOMBRE VARCHAR(50) NOT NULL UNIQUE,
  	LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL
	
);


CREATE TABLE FACTURASXPERSONAS(
    IDFACTURA INT NOT NULL,
    IDCEDULA INT NOT NULL,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
    PRIMARY KEY (IDFACTURA,IDCEDULA)
);

CREATE TABLE FACTURASXCAJEROS(
    IDFACTURA INT NOT NULL,
    IDCEDULA INT NOT NULL,
    LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
    PRIMARY KEY (IDFACTURA,IDCEDULA)
);

CREATE TABLE PRODUCTOSXSUCURSALES(
 	IDPRODUCTO INT NOT NULL,
  	IDSUCURSAL INT NOT NULL,
  	PRECIO INT NOT NULL,
  	MINIMO INT NOT NULL,
  	PROMEDIO INT NOT NULL,
  	CANTIDADSUCURSAL INT NOT NULL,
	LOGICDELETE	BIT			DEFAULT 0::BIT		NOT NULL,
  	PRIMARY KEY (IDPRODUCTO,IDSUCURSAL)
);


ALTER TABLE PRODUCTOSXPROVEEDORES ADD CONSTRAINT FKPRODUCTOSXPROVEEDORESPRODUCTOS
FOREIGN KEY (IDPRODUCTO) REFERENCES PRODUCTOS(IDPRODUCTO);

ALTER TABLE PRODUCTOSXPROVEEDORES ADD CONSTRAINT FKPRODUCTOSXPROVEEDORESPROVEEDORES
FOREIGN KEY (IDPROVEEDOR) REFERENCES PROVEEDORES(IDPROVEEDOR);

ALTER TABLE PRODUCTOSXFACTURAS ADD CONSTRAINT FKPRODUCTOSXFACTURASFACTURAS
FOREIGN KEY (IDFACTURA) REFERENCES FACTURAS(IDFACTURA);

ALTER TABLE PRODUCTOSXFACTURAS ADD CONSTRAINT FKPRODUCTOSXFACTURASPRODUCTOS
FOREIGN KEY (IDPRODUCTO) REFERENCES PRODUCTOS(IDPRODUCTO);

ALTER TABLE FORMAPAGOSXFACTURAS ADD CONSTRAINT FKFORMAPAGOSXFACTURASFACTURAS
FOREIGN KEY (IDFACTURA) REFERENCES FACTURAS(IDFACTURA);

ALTER TABLE FORMAPAGOSXFACTURAS ADD CONSTRAINT FKFORMAPAGOSXFACTURASFORMAPAGOS
FOREIGN KEY (IDFORMAPAGO) REFERENCES FORMAPAGOS(IDFORMAPAGO);

ALTER TABLE PRODUCTOSXSUCURSALES ADD CONSTRAINT FKPRODUCTOSXSUCURSALESPRODUCTOS
FOREIGN KEY (IDPRODUCTO) REFERENCES PRODUCTOS(IDPRODUCTO);

ALTER TABLE PRODUCTOSXSUCURSALES ADD CONSTRAINT FKPRODUCTOSXSUCURSALESSUCURSALES
FOREIGN KEY (IDSUCURSAL) REFERENCES SUCURSALES(IDSUCURSAL);

ALTER TABLE SUCURSALESXCOMPANIAS ADD CONSTRAINT FKSUCURSALESXCOMPANIASCOMPANIAS
FOREIGN KEY (IDCOMPANIA) REFERENCES COMPANIAS(IDCOMPANIA);

ALTER TABLE SUCURSALESXCOMPANIAS ADD CONSTRAINT FKSUCURSALESXCOMPANIASSUCURSALES
FOREIGN KEY (IDSUCURSAL) REFERENCES SUCURSALES(IDSUCURSAL);

ALTER TABLE FACTURASXSUCURSALES ADD CONSTRAINT FKFACTURASXSUCURSALESFACTURAS
FOREIGN KEY (IDFACTURA) REFERENCES FACTURAS(IDFACTURA);

ALTER TABLE FACTURASXSUCURSALES ADD CONSTRAINT FKFACTURASXSUCURSALESSUCURSALES
FOREIGN KEY (IDSUCURSAL) REFERENCES SUCURSALES(IDSUCURSAL);

ALTER TABLE PERSONASXSUCURSALES ADD CONSTRAINT FKPERSONASXSUCURSALESPERSONAS
FOREIGN KEY (IDCEDULA) REFERENCES PERSONAS(IDCEDULA);

ALTER TABLE PERSONASXSUCURSALES ADD CONSTRAINT FKPERSONASXSUCURSALESSUCURSALES
FOREIGN KEY (IDSUCURSAL) REFERENCES SUCURSALES(IDSUCURSAL);

ALTER TABLE ROLESXPERSONAS ADD CONSTRAINT FKROLESXPERSONASROLES
FOREIGN KEY (IDROL) REFERENCES ROLES(IDROL);

ALTER TABLE ROLESXPERSONAS ADD CONSTRAINT FKROLESXPERSONASPERSONAS
FOREIGN KEY (IDCEDULA) REFERENCES PERSONAS(IDCEDULA);

ALTER TABLE FACTURASXPERSONAS ADD CONSTRAINT FKFACTURASXPERSONASFACTURAS
FOREIGN KEY (IDFACTURA) REFERENCES FACTURAS(IDFACTURA);

ALTER TABLE FACTURASXPERSONAS ADD CONSTRAINT FKFACTURASXPERSONASPERSONAS
FOREIGN KEY (IDCEDULA) REFERENCES PERSONAS(IDCEDULA);

ALTER TABLE FACTURASXCAJEROS ADD CONSTRAINT FKFACTURASXCAJEROSFACTURAS
FOREIGN KEY (IDFACTURA) REFERENCES FACTURAS(IDFACTURA);

ALTER TABLE FACTURASXCAJEROS ADD CONSTRAINT FKFACTURASXCAJEROSPERSONAS
FOREIGN KEY (IDCEDULA) REFERENCES PERSONAS(IDCEDULA);

